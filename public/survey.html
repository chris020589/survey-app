/* ✅ 📁 client/survey.html (問卷填寫頁) */
/*
<!DOCTYPE html>
<html>
<head>
  <title>問卷填寫</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <h1 id="title"></h1>
  <p id="desc"></p>
  <form id="surveyForm"></form>
  <button onclick="submitSurvey()">提交</button>

  <script>
    let surveyId = new URLSearchParams(location.search).get('id');
    let surveyData;

    axios.get(`http://localhost:5000/api/surveys/${surveyId}`).then(res => {
      surveyData = res.data;
      document.getElementById('title').innerText = surveyData.title;
      document.getElementById('desc').innerText = surveyData.description;
      let form = document.getElementById('surveyForm');

      surveyData.questions.forEach((q, idx) => {
        let div = document.createElement('div');
        div.innerHTML = `<p>${q.questionText}</p>`;

        if (q.type === 'single') {
          q.options.forEach(opt => {
            div.innerHTML += `<label><input type="radio" name="q${idx}" value="${opt}">${opt}</label><br>`;
          });
        } else if (q.type === 'multiple') {
          q.options.forEach(opt => {
            div.innerHTML += `<label><input type="checkbox" name="q${idx}" value="${opt}">${opt}</label><br>`;
          });
        } else {
          div.innerHTML += `<input name="q${idx}" type="text"><br>`;
        }

        form.appendChild(div);
      });
    });

    function submitSurvey() {
      let answers = surveyData.questions.map((q, idx) => {
        if (q.type === 'single') {
          return document.querySelector(`input[name=q${idx}]:checked`)?.value;
        } else if (q.type === 'multiple') {
          return Array.from(document.querySelectorAll(`input[name=q${idx}]:checked`)).map(e => e.value);
        } else {
          return document.querySelector(`input[name=q${idx}]`).value;
        }
      });

      axios.post(`http://localhost:5000/api/surveys/${surveyId}/answers`, { answers })
        .then(() => alert('提交成功！'));
    }
  </script>
</body>
</html>
*/
